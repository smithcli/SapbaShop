var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},r=e.parcelRequiree437;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in n){var r=n[e];delete n[e];var o={id:e,exports:{}};return t[e]=o,r.call(o.exports,o,o.exports),o.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},e.parcelRequiree437=r),r.register("1OSxw",(function(e,t){var n=r("5XY6w"),o=r("dVqJJ"),s=r("jdEhU"),i=r("eQOXu");const c=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function a(e){console.log(`[dotenv][DEBUG] ${e}`)}const l={config:function(e){let t=s.resolve(n.cwd(),".env"),r="utf8";const c=Boolean(e&&e.debug),d=Boolean(e&&e.override);var u;e&&(null!=e.path&&(t="~"===(u=e.path)[0]?s.join(i.homedir(),u.slice(1)):u),null!=e.encoding&&(r=e.encoding));try{const e=l.parse(o.readFileSync(t,{encoding:r}));return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(n.env,t)?(!0===d&&e[t],c&&a(!0===d?`"${t}" is already defined in \`process.env\` and WAS overwritten`:`"${t}" is already defined in \`process.env\` and was NOT overwritten`)):e[t]})),{parsed:e}}catch(e){return c&&a(`Failed to load ${t} ${e.message}`),{error:e}}},parse:function(e){const t={};let n,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(n=c.exec(r));){const e=n[1];let r=n[2]||"";r=r.trim();const o=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===o&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),t[e]=r}return t}};e.exports.config=l.config,e.exports.parse=l.parse,e.exports=l})),r.register("5XY6w",(function(e,t){var n,r,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var a,l=[],d=!1,u=-1;function f(){d&&a&&(d=!1,a.length?l=a.concat(l):u=-1,l.length&&h())}function h(){if(!d){var e=c(f);d=!0;for(var t=l.length;t;){for(a=l,l=[];++u<t;)a&&a[u].run();u=-1,t=l.length}a=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||d||c(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}})),r.register("dVqJJ",(function(e,t){})),r.register("jdEhU",(function(e,t){var n=r("5XY6w");function o(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function s(e,t){for(var n,r="",o=0,s=-1,i=0,c=0;c<=e.length;++c){if(c<e.length)n=e.charCodeAt(c);else{if(47===n)break;n=47}if(47===n){if(s===c-1||1===i);else if(s!==c-1&&2===i){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var a=r.lastIndexOf("/");if(a!==r.length-1){-1===a?(r="",o=0):o=(r=r.slice(0,a)).length-1-r.lastIndexOf("/"),s=c,i=0;continue}}else if(2===r.length||1===r.length){r="",o=0,s=c,i=0;continue}t&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+e.slice(s+1,c):r=e.slice(s+1,c),o=c-s-1;s=c,i=0}else 46===n&&-1!==i?++i:i=-1}return r}var i={resolve:function(){for(var e,t="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var c;i>=0?c=arguments[i]:(void 0===e&&(e=n.cwd()),c=e),o(c),0!==c.length&&(t=c+"/"+t,r=47===c.charCodeAt(0))}return t=s(t,!r),r?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(o(e),0===e.length)return".";var t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=s(e,!t)).length||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return o(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];o(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":i.normalize(e)},relative:function(e,t){if(o(e),o(t),e===t)return"";if((e=i.resolve(e))===(t=i.resolve(t)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var r=e.length,s=r-n,c=1;c<t.length&&47===t.charCodeAt(c);++c);for(var a=t.length-c,l=s<a?s:a,d=-1,u=0;u<=l;++u){if(u===l){if(a>l){if(47===t.charCodeAt(c+u))return t.slice(c+u+1);if(0===u)return t.slice(c+u)}else s>l&&(47===e.charCodeAt(n+u)?d=u:0===u&&(d=0));break}var f=e.charCodeAt(n+u);if(f!==t.charCodeAt(c+u))break;47===f&&(d=u)}var h="";for(u=n+d+1;u<=r;++u)u!==r&&47!==e.charCodeAt(u)||(0===h.length?h+="..":h+="/..");return h.length>0?h+t.slice(c+d):(c+=d,47===t.charCodeAt(c)&&++c,t.slice(c))},_makeLong:function(e){return e},dirname:function(e){if(o(e),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,s=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!s){r=i;break}}else s=!1;return-1===r?n?"/":".":n&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');o(e);var n,r=0,s=-1,i=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var c=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){var l=e.charCodeAt(n);if(47===l){if(!i){r=n+1;break}}else-1===a&&(i=!1,a=n+1),c>=0&&(l===t.charCodeAt(c)?-1==--c&&(s=n):(c=-1,s=a))}return r===s?s=a:-1===s&&(s=e.length),e.slice(r,s)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!i){r=n+1;break}}else-1===s&&(i=!1,s=n+1);return-1===s?"":e.slice(r,s)},extname:function(e){o(e);for(var t=-1,n=0,r=-1,s=!0,i=0,c=e.length-1;c>=0;--c){var a=e.charCodeAt(c);if(47!==a)-1===r&&(s=!1,r=c+1),46===a?-1===t?t=c:1!==i&&(i=1):-1!==t&&(i=-1);else if(!s){n=c+1;break}}return-1===t||-1===r||0===i||1===i&&t===r-1&&t===n+1?"":e.slice(t,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+e+r:r}("/",e)},parse:function(e){o(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,r=e.charCodeAt(0),s=47===r;s?(t.root="/",n=1):n=0;for(var i=-1,c=0,a=-1,l=!0,d=e.length-1,u=0;d>=n;--d)if(47!==(r=e.charCodeAt(d)))-1===a&&(l=!1,a=d+1),46===r?-1===i?i=d:1!==u&&(u=1):-1!==i&&(u=-1);else if(!l){c=d+1;break}return-1===i||-1===a||0===u||1===u&&i===a-1&&i===c+1?-1!==a&&(t.base=t.name=0===c&&s?e.slice(1,a):e.slice(c,a)):(0===c&&s?(t.name=e.slice(1,i),t.base=e.slice(1,a)):(t.name=e.slice(c,i),t.base=e.slice(c,a)),t.ext=e.slice(i,a)),c>0?t.dir=e.slice(0,c-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};i.posix=i,e.exports=i})),r.register("eQOXu",(function(e,t){var n,r,o,s,i;n=e.exports,r="homedir",o=()=>i,s=e=>i=e,Object.defineProperty(n,r,{get:o,set:s,enumerable:!0,configurable:!0}),i=function(){return"/"}})),r.register("92YpJ",(function(e,t){e.exports={}})),r.register("kGjUS",(function(e,t){const n=/^dotenv_config_(encoding|path|debug|override)=(.+)$/;e.exports=function(e){return e.reduce((function(e,t){const r=t.match(n);return r&&(e[r[1]]=r[2]),e}),{})}}));const o=(e,t)=>{const n=document.getElementsByClassName("nav-bar-tab");document.querySelector(".nav-bar__item--selected").classList.remove("nav-bar__item--selected"),e.classList.add("nav-bar__item--selected");for(let e=0;e<n.length;e++){const r=n[e];e===t||r.classList.contains("hidden")?e===t&&r.classList.remove("hidden"):r.classList.add("hidden")}};var s=r("5XY6w");r("1OSxw").config(Object.assign({},r("92YpJ"),r("kGjUS")(s.argv)));var i=async(e,t,n)=>await fetch(`https://192.168.0.3:8000/api/v1${e}`,{method:t,headers:{"Content-type":"application/json"},body:JSON.stringify(n),credentials:"same-origin"}).then((async e=>{const t=e.headers.get("Content-type")?.includes("application/json"),n=t?await e.json():e;if(!e.ok){const t=n&&n.message||e.status;return Promise.reject(t)}return n}));const c=()=>{const e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},a=(e,t,n)=>{n||(n="body"),c();const r=`<div class="alert alert-${e}">${t}</div>`;document.querySelector(n).insertAdjacentHTML("afterbegin",r),window.setTimeout(c,3e3)},l=async()=>{try{"success"===(await i("/users/logout","GET")).status&&(a("pass","Logging out"),window.setTimeout((()=>{window.location.assign("/login")}),1e3))}catch(e){a("fail",`Error: ${e}. Please try again.`)}},d=["Grocery","Clothing and Accessories","Beauty and Personal Care","Health and Wellness","Household"],u=e=>{const t=[];return d.forEach((n=>{e.department.en===n?t.push(e.count):t.push(null)})),t},f=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,h=(e,t)=>`hsla(${e}, ${f(50,100)}%, ${f(30,60)}%,${t})`,g=e=>{switch(e){case d[0]:return h(120,.75);case d[1]:return h(30,.75);case d[2]:return h(210,.75);case d[3]:return h(360,.75);case d[4]:return h(270,.75);default:throw new Error("Not a valid department")}},p=async e=>{try{const t=await i(`/products/mgt?store=${e}&sort=product.name.en`,"GET"),n={avgCount:0,labels:d};return n.datasets=t.data.products.map((e=>{n.avgCount+=e.count;let t=e.name.en;return e.size&&(t+=` ${e.size}`),{label:t,data:u(e),backgroundColor:[g(e.department.en)],borderWidth:.5}})),n.avgCount/=t.data.products.length,n}catch(e){console.log(e)}},m=async e=>{try{const t=[];let n=0;for(const r of e){const{avgCount:e,...o}=await p(r.children[1].id);n+=e;const s=new Chart(r.children[1],{type:"bar",data:o,options:{datasets:{bar:{skipNull:!0}},plugins:{legend:{display:!1}}}});t.push(s)}n=Math.round(n/e.length),t.forEach((e=>{e.options.scales.y.max=2*n,e.update()}))}catch(e){console.log(e)}};const v=document.getElementsByClassName("form__group"),y=document.getElementsByClassName("hidden"),b=document.createElement("img");b.setAttribute("src","/img/icons/icons8-close-window-48.png"),b.setAttribute("alt","Cancel editing button");const w=document.createElement("img");w.setAttribute("src","/img/icons/icons8-edit-48.png"),w.setAttribute("alt","Pencil as an edit button");document.getElementById("zip"),document.getElementById("phone");const E=document.getElementById("active"),T=document.getElementById("product-table"),C=document.getElementById("hidden-add"),A=[],L=[],$=e=>{let t=e.target;for(let n=0;n<5;n++)e.target.classList.contains("display")?(A.push(t),t.style.display="none",t=t.previousSibling):(t=t.previousSibling,t.nextSibling.remove())},k=e=>{if(e.classList.contains("btn--close"))(e=>{e.form.reset();for(const e of v)e.setAttribute("disabled",null);for(const e of y)e.style.visibility="hidden",e.classList.contains("display")||(e.style.display="none");(A||L)&&(A.forEach((e=>{e.style.display="block"})),L.forEach((e=>{e.remove()}))),e.replaceChild(w,e.lastChild),e.classList.remove("btn--close")})(e);else{for(const e of v)e.removeAttribute("disabled");for(const e of y)e.style.visibility="visible",e.style.display=e.classList.contains("grid")?"grid":"block";e.replaceChild(b,e.lastChild),e.classList.add("btn--close")}},x=e=>{const t={};for(const[n,r]of e)if(n.includes(".")){const[e,o]=n.split(".");t[e]||(t[e]={}),t[e][o]=r}else t[n]=r;return t},S=e=>{const{model:t,route:n}=e.dataset,r=n?JSON.parse(n):[],o=[],s=[];A.forEach(((e,t)=>{t%5==0&&s.push(e.id)})),s.forEach((e=>{o.push({reqType:"DELETE",endpoint:`/${t}/${r[e]}`})}));const i=x((e=>{const t=new FormData(e);return t.delete("store"),t.delete("size"),t.delete("price"),t.delete("count"),t})(e)),c=(e=>{const t=new FormData(e);return t.delete("name.en"),t.delete("name.th"),t.delete("description.en"),t.delete("description.th"),t.delete("department.en"),t.delete("unit.en"),t.delete("unit.th"),t})(e);let a,l=-1;const d=c.getAll("store").length-1;for(const[e,n]of c){if("store"===e&&(l+=1),l===d)break;s.includes(l.toString())||("store"===e&&(a={}),a[e]=n,"count"===e&&l<=r.length-1?(a=Object.assign(a,i),o.push({reqType:"PATCH",endpoint:`/${t}/${r[l]}`,obj:a})):"count"===e&&l>r.length-1&&(a=Object.assign(a,i),o.push({reqType:"POST",endpoint:`/${t}`,obj:a})))}return o},O=e=>{const{model:t,route:n}=e.dataset;if("products"===t)return S(e);const r=x(new FormData(e));"users"===t&&(e=>{E&&!E.checked&&(e.active=!1)})(r);const{endpoint:o,reqType:s}=((e,t)=>({endpoint:t?`/${e}/${t}`:`/${e}`,reqType:t?"PATCH":"POST"}))(t,n);return{reqType:s,endpoint:o,obj:r}},j=async e=>{const t=e.classList.contains("btn--save")?O(e.form):(e=>{const{model:t,route:n}=e.dataset;if("products"===t)return JSON.parse(n).map((e=>({endpoint:`/${t}/${e}`,reqType:"DELETE"})));return{endpoint:`/${t}/${n}`,reqType:"DELETE"}})(e.form);if(Array.isArray(t))try{const n=[];for(const e of t){const{endpoint:t,reqType:r,obj:o}=e;n.push(i(t,r,o))}const r=await Promise.all(n);if("success"===r[0].status||204===r[0].status){const t=e.classList.contains("btn--delete")?"Deleted":"Saved";a("pass",`${t} successfully!`),window.setTimeout((()=>{window.location=document.referrer}),1500)}}catch(e){a("fail",e)}else try{const{endpoint:e,reqType:n,obj:r}=t,o=await i(e,n,r);if("success"===o.status||204===o.status){a("pass",`${"DELETE"===n?"Deleted":"Saved"} successfully!`),"DELETE"===n&&"/users/me"===e?window.setTimeout((()=>{window.location.assign("/login")}),1e3):"DELETE"===n||"POST"===n?window.setTimeout((()=>{window.location=document.referrer}),1e3):window.setTimeout((()=>{window.location.reload()}),1e3)}}catch(e){a("fail",e)}},q=document.getElementById("menu"),N=document.getElementById("closeMenu"),B=document.getElementById("side-nav"),D=document.querySelector(".nav-bar"),P=document.querySelector(".btn--back"),_=document.querySelector(".btn--edit"),I=document.querySelectorAll(".btn--save"),J=document.querySelectorAll(".btn--delete"),U=document.getElementById("logout"),z=document.getElementsByClassName("chart-current-report"),F=document.getElementById("add-row"),G=document.querySelectorAll(".btn--delete-icon");q&&B&&q.addEventListener("click",(e=>{B.style.width="250px"})),N&&B&&N.addEventListener("click",(e=>{B.style.width="0"})),D&&D.childNodes.forEach(((e,t)=>{e.addEventListener("click",(n=>{o(e,t)}))})),P&&P.addEventListener("click",(e=>{window.location=document.referrer})),U&&U.addEventListener("click",(e=>l())),0!==z.length&&m(z),_&&_.addEventListener("click",(e=>{e.preventDefault(),k(_)})),I&&I.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),j(e)}))})),J&&J.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),j(e)}))})),F&&F.addEventListener("click",(e=>{(()=>{const e=C.cloneNode(!0),t=T.childNodes.length/5;e.childNodes.forEach((e=>{e.id+=`${t}`})),e.childNodes.item(4).addEventListener("click",(e=>$(e))),L.push(...e.childNodes),T.append(...e.childNodes)})()})),G&&G.forEach((e=>{e.addEventListener("click",(e=>{$(e)}))}));
//# sourceMappingURL=sapba.js.map
